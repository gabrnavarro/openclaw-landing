1:"$Sreact.fragment"
2:I[22016,["/openclaw-landing/_next/static/chunks/744355e03808d4c7.js","/openclaw-landing/_next/static/chunks/7c92e96509cd355e.js"],""]
7:I[97367,["/openclaw-landing/_next/static/chunks/ff1a16fafef87110.js","/openclaw-landing/_next/static/chunks/d2be314c3ece3fbe.js"],"OutletBoundary"]
8:"$Sreact.suspense"
3:Taf3,<p>Recently, I joined a game in Crowdpurr, an online trivia game app where people can answer trivia quesitons in multiple choice format. With everyone working from home, it quickly became a competition between who googles the answers the fastest. So, I decided to make a script to google the answers as soon as my browser picks up the questions.</p>
<p>Crowdpurr sends the data to and from the server using a single websocket connection. This is created as soon as your page loads. So my idea was, to be able to pick up the questions, I need to add my own listener to the websocket. To do that, I used a tool called Tampermonkey.</p>
<p>Tampermonkey is a userscript manager that lets you run Javascript on the browser.</p>
<pre><code>// ==UserScript==
// @name         Crwdlive script
// @include      /^https://crowd.live
// @include      /^https://www.crowd.live
// @run-at       document-start
// @grant        none
// ==/UserScript==
</code></pre>
<p>The <code>@include</code> directive tells the script to only run on the specified domain, while the <code>@run-at</code> directive tells the script when to run.</p>
<p>To get the websocket object, I simply wrapped the <code>WebSocket</code> constructor around a new function where I store a reference of the websocket object in the window so I can play around with it. Now, whenever the constructor is called, the function will add the socket instance into our <code>window</code>.</p>
<pre><code>window.mysocket = undefined;
const nativeWebSocket = window.WebSocket;
window.WebSocket = function(...args){
  const socket = new nativeWebSocket(...args);
  window.mysocket = socket;
  return socket;
};
</code></pre>
<p>Now that we already have the socket, we can now do things with it! In my case, I simply added a listener that picks up the question in the json body and adds the query in a google URL.</p>
<pre><code>  window.mysocket.addEventListener('message', eventListener);
</code></pre>
<pre><code>const eventListener = function (event) {
let jsonData = event.data.substring(2);
jsonData = jsonData.slice(0, -1);
jsonData = JSON.parse(jsonData);
jsonData = JSON.parse(jsonData);
if (jsonData.msg == 'result') {
    let result = jsonData.result;
    if (result &#x26;&#x26; typeof result.forEach === 'function') {
        result.forEach(item => {
            if ('questionType' in item) {
                console.log(item.body);
                const google = "https://www.google.com/search?q=" + item.body;
                setTimeout(() => {
                    window.open(encodeURI(google));
                }, 500);
            }
        });
    }
}
};
</code></pre>
<p>You can play around with the websocket object as you like. In my case, I was able to request questions ahead of time by sending the same requests the app would do!</p>
0:{"buildId":"FmlDgMI7snZSJRl5UO4eV","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"min-h-screen bg-white text-neutral-950","children":[["$","div",null,{"className":"pointer-events-none fixed inset-0 -z-10","children":[["$","div",null,{"className":"absolute inset-0 bg-gradient-to-b from-white via-white to-zinc-50"}],["$","div",null,{"className":"absolute left-1/2 top-[-240px] h-[520px] w-[520px] -translate-x-1/2 rounded-full bg-blue-200/35 blur-3xl"}],["$","div",null,{"className":"absolute left-[20%] top-[240px] h-[420px] w-[420px] rounded-full bg-emerald-200/25 blur-3xl"}]]}],["$","main",null,{"className":"mx-auto w-full max-w-3xl px-6 py-16 sm:py-20","children":[["$","div",null,{"className":"flex items-center justify-between","children":[["$","$L2",null,{"href":"/blog","className":"inline-flex h-10 items-center justify-center rounded-full border border-neutral-200 bg-white px-4 text-sm font-medium text-neutral-900 shadow-sm transition hover:bg-neutral-50","children":"← Blog"}],["$","$L2",null,{"href":"/","className":"inline-flex h-10 items-center justify-center rounded-full border border-neutral-200 bg-white px-4 text-sm font-medium text-neutral-900 shadow-sm transition hover:bg-neutral-50","children":"Home"}]]}],["$","article",null,{"className":"mt-10 overflow-hidden rounded-3xl border border-neutral-200 bg-white shadow-sm","children":[["$","header",null,{"className":"border-b border-neutral-100 p-6 sm:p-8","children":[["$","div",null,{"className":"text-xs text-neutral-500","children":"May 19, 2020"}],["$","h1",null,{"className":"mt-2 text-3xl font-semibold tracking-tight","children":"Accessing websocket data using userscripts"}],["$","div",null,{"className":"mt-4 flex flex-wrap gap-2","children":[["$","span","javascript",{"className":"rounded-full border border-neutral-200 bg-white px-2.5 py-1 text-[11px] text-neutral-700","children":"javascript"}],["$","span","userscripts",{"className":"rounded-full border border-neutral-200 bg-white px-2.5 py-1 text-[11px] text-neutral-700","children":"userscripts"}]]}]]}],["$","div",null,{"className":"prose prose-neutral blog-prose max-w-none p-6 sm:p-8 prose-headings:tracking-tight prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline","dangerouslySetInnerHTML":{"__html":"$3"}}]]}],"$L4"]}]]}],["$L5"],"$L6"]}],"loading":null,"isPartial":false}
4:["$","nav",null,{"className":"mt-8 flex items-center justify-between gap-4 text-sm","children":[["$","div",null,{"children":["$","$L2",null,{"className":"text-neutral-700 hover:underline","href":"/blog/nginx-consul","children":["← ","Setting up an NGINX proxy using consul-template and puppet"]}]}],["$","div",null,{"className":"text-right","children":["$","$L2",null,{"className":"text-neutral-700 hover:underline","href":"/blog/container-issues","children":["Disk quota exceeded error in docker containers"," →"]}]}]]}]
5:["$","script","script-0",{"src":"/openclaw-landing/_next/static/chunks/7c92e96509cd355e.js","async":true}]
6:["$","$L7",null,{"children":["$","$8",null,{"name":"Next.MetadataOutlet","children":"$@9"}]}]
9:null
